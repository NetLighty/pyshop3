import{Q as w,a as d}from"./QForm.bac847a1.js";import{Q as y}from"./vm.e1a0da41.js";import{P as b}from"./PrimaryButton.676e9e17.js";import{_ as E,f as x,g as V,h as a,o as m,a as k,e as c,w as P,A as F,U as L,d as r,t as S,i as g,j as p,k as U,u as A,r as B}from"./index.42e2b6da.js";import{v as Q}from"./emailValidation.001f0b79.js";const R={setup(){const l=A(),s=x(),u=V(()=>s.isAuth),e=a(""),n=a(""),i=a(!1),t=a(!1),o=()=>{l.push("/registration")},h=async()=>{try{t.value=!0,await new Promise(v=>setTimeout(v,600)),await F.login({email:e.value,password:n.value});const f=await L.getUser();s.setIsAuth(!0),s.setUser(f.data),l.push("/profile")}catch{i.value=!0,t.value=!1}},_=()=>{i.value=!1};return{store:s,isAuth:u,loginError:i,isPwd:a(!0),email:e,isLoading:t,password:n,submitForm:h,pushToRegistration:o,hideErrorMsg:_,validateEmail:Q}},components:{PrimaryButton:b}},T={class:"absolute-center"},C=r("h1",{class:"form-title"},"Login",-1),N={class:"text-negative error-msg"},z={class:"submit"},I={class:"q-mt-md text-grey"};function M(l,s,u,e,n,i){const t=B("primary-button");return m(),k("div",T,[c(w,{onSubmit:e.submitForm},{default:P(()=>[C,c(d,{onFocus:e.hideErrorMsg,filled:"",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=o=>e.email=o),label:"Email","label-color":"grey",color:"white","lazy-rules":"",rules:[o=>!!o||"Email is missing",()=>e.validateEmail(e.email)||"Invalid email"]},null,8,["onFocus","modelValue","rules"]),c(d,{onFocus:e.hideErrorMsg,filled:"",modelValue:e.password,"onUpdate:modelValue":s[1]||(s[1]=o=>e.password=o),label:"Password","label-color":"grey",color:"white",type:"password","lazy-rules":"",rules:[o=>o&&o.length>0||"Please type something"]},null,8,["onFocus","modelValue","rules"]),r("p",N,S(e.loginError?"Email or password is incorrect":""),1),r("div",z,[e.isLoading?p("",!0):(m(),g(t,{key:0,class:"btn",text:"Login"})),e.isLoading?(m(),g(y,{key:1,color:"white",size:"4rem",thickness:2})):p("",!0)]),r("p",I,[U(" Don't have an account? "),r("a",{onClick:s[2]||(s[2]=(...o)=>e.pushToRegistration&&e.pushToRegistration(...o)),class:"q-ml-sm text-white cursor-pointer"},"Registration")])]),_:1},8,["onSubmit"])])}var J=E(R,[["render",M]]);export{J as default};
