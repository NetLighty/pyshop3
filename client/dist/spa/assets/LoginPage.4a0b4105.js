import{Q as v,a as d}from"./QForm.52097ba5.js";import{Q as w}from"./vm.6ec6daf4.js";import{P as y}from"./PrimaryButton.e15b86c6.js";import{_ as b,u as g,h as E,i as n,o as u,a as x,e as c,w as V,A as k,U as F,d as a,t as L,j as p,k as h,l as P,g as R,f as S}from"./index.abd329e6.js";import{v as A}from"./emailValidation.001f0b79.js";const T={setup(){const i=R(),o=g(),t=E(()=>o.isAuth),e=n(""),m=n(""),l=n(!1),r=n(!1);return{store:o,isAuth:t,loginError:l,email:e,isLoading:r,password:m,submitForm:async()=>{try{r.value=!0,await new Promise(_=>setTimeout(_,400)),await k.login({email:e.value,password:m.value});const f=await F.getUser();o.setIsAuth(!0),o.setUser(f.data),i.push("/profile")}catch{l.value=!0,r.value=!1}},pushToRegistration:()=>{i.push("/registration")},hideErrorMsg:()=>{l.value=!1},validateEmail:A}},components:{PrimaryButton:y},beforeRouteEnter(i,o,t){g().isAuth?t("/profile"):t()}},U={class:"absolute-center"},B=a("h1",{class:"page-title"},"Login",-1),Q={class:"text-negative error-msg"},C={class:"submit"},M={class:"q-mt-md text-grey"};function N(i,o,t,e,m,l){const r=S("primary-button");return u(),x("div",U,[c(v,{onSubmit:e.submitForm},{default:V(()=>[B,c(d,{onFocus:e.hideErrorMsg,filled:"",modelValue:e.email,"onUpdate:modelValue":o[0]||(o[0]=s=>e.email=s),label:"Email","label-color":"grey",color:"white","lazy-rules":"",rules:[s=>!!s||"Email is missing",()=>e.validateEmail(e.email)||"Invalid email"]},null,8,["onFocus","modelValue","rules"]),c(d,{onFocus:e.hideErrorMsg,filled:"",modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=s=>e.password=s),label:"Password","label-color":"grey",color:"white",type:"password","lazy-rules":"",rules:[s=>s&&s.length>0||"Please type something"]},null,8,["onFocus","modelValue","rules"]),a("p",Q,L(e.loginError?"Email or password is incorrect":""),1),a("div",C,[e.isLoading?h("",!0):(u(),p(r,{key:0,class:"btn",text:"Login"})),e.isLoading?(u(),p(w,{key:1,color:"white",size:"4rem",thickness:2})):h("",!0)]),a("p",M,[P(" Don't have an account? "),a("a",{onClick:o[2]||(o[2]=(...s)=>e.pushToRegistration&&e.pushToRegistration(...s)),class:"q-ml-sm text-white cursor-pointer tight-text"},"Registration")])]),_:1},8,["onSubmit"])])}var J=b(T,[["render",N]]);export{J as default};
