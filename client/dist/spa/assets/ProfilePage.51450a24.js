import{c as I,h as Z,b as ne,d as le}from"./vm.6ec6daf4.js";import{h as y,H as q,i as g,P as ie,B as oe,s as V,m as N,n as ae,p as se,Q as re,R as ue,G as ce,S as B,V as de,M as fe,W as ve,_ as me,u as M,A as ge,o as E,a as z,e as k,w as S,k as T,U as W,d as H,F as he,r as ye,l as be,t as O,X as j,j as D,f as K}from"./index.abd329e6.js";import{u as we,a as ke,c as X,g as _e,Q as Y}from"./QBtn.31925eb5.js";import{u as ee,b as te,Q as qe,a as G}from"./QForm.52097ba5.js";import{Q as J,H as Ce}from"./ProfileHeader.665ac331.js";import{P as Se}from"./PrimaryButton.e15b86c6.js";var pe=I({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:o}){const n=y(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>q("div",{class:n.value},Z(o.default))}}),Q=I({name:"QItem",props:{...ee,...we,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(e,{slots:o,emit:n}){const{proxy:{$q:t}}=V(),u=te(e,t),{hasLink:c,linkAttrs:v,linkClass:b,linkTag:i,navigateOnClick:d}=ke(),m=g(null),w=g(null),_=y(()=>e.clickable===!0||c.value===!0||e.tag==="label"),s=y(()=>e.disable!==!0&&_.value===!0),p=y(()=>"q-item q-item-type row no-wrap"+(e.dense===!0?" q-item--dense":"")+(u.value===!0?" q-item--dark":"")+(c.value===!0&&e.active===null?b.value:e.active===!0?` q-item--active${e.activeClass!==void 0?` ${e.activeClass}`:""}`:"")+(e.disable===!0?" disabled":"")+(s.value===!0?" q-item--clickable q-link cursor-pointer "+(e.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(e.focused===!0?" q-manual-focusable--focused":""):"")),L=y(()=>{if(e.insetLevel===void 0)return null;const a=t.lang.rtl===!0?"Right":"Left";return{["padding"+a]:16+e.insetLevel*56+"px"}});function f(a){s.value===!0&&(w.value!==null&&(a.qKeyEvent!==!0&&document.activeElement===m.value?w.value.focus():document.activeElement===w.value&&m.value.focus()),d(a))}function r(a){if(s.value===!0&&ie(a,13)===!0){oe(a),a.qKeyEvent=!0;const l=new MouseEvent("click",a);l.qKeyEvent=!0,m.value.dispatchEvent(l)}n("keyup",a)}function C(){const a=ne(o.default,[]);return s.value===!0&&a.unshift(q("div",{class:"q-focus-helper",tabindex:-1,ref:w})),a}return()=>{const a={ref:m,class:p.value,style:L.value,role:"listitem",onClick:f,onKeyup:r};return s.value===!0?(a.tabindex=e.tabindex||"0",Object.assign(a,v.value)):_.value===!0&&(a["aria-disabled"]="true"),q(i.value,a,C())}}}),xe=I({name:"QList",props:{...ee,bordered:Boolean,dense:Boolean,separator:Boolean,padding:Boolean,tag:{type:String,default:"div"}},setup(e,{slots:o}){const n=V(),t=te(e,n.proxy.$q),u=y(()=>"q-list"+(e.bordered===!0?" q-list--bordered":"")+(e.dense===!0?" q-list--dense":"")+(e.separator===!0?" q-list--separator":"")+(t.value===!0?" q-list--dark":"")+(e.padding===!0?" q-list--padding":""));return()=>q(e.tag,{class:u.value,role:"list"},Z(o.default))}});const Ee=[null,document,document.body,document.scrollingElement,document.documentElement];function Pe(e,o){let n=_e(o);if(n===void 0){if(e==null)return window;n=e.closest(".scroll,.scroll-y,.overflow-auto")}return Ee.includes(n)?window:n}function Ie(e){return e===window?window.pageYOffset||window.scrollY||document.body.scrollTop||0:e.scrollTop}function Le(e){return e===window?window.pageXOffset||window.scrollX||document.body.scrollLeft||0:e.scrollLeft}let R;function A(){if(R!==void 0)return R;const e=document.createElement("p"),o=document.createElement("div");X(e,{width:"100%",height:"200px"}),X(o,{position:"absolute",top:"0px",left:"0px",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),o.appendChild(e),document.body.appendChild(o);const n=e.offsetWidth;o.style.overflow="scroll";let t=e.offsetWidth;return n===t&&(t=o.clientWidth),o.remove(),R=n-t,R}const{passive:$}=ue,Be=["both","horizontal","vertical"];var ze=I({name:"QScrollObserver",props:{axis:{type:String,validator:e=>Be.includes(e),default:"vertical"},debounce:[String,Number],scrollTarget:{default:void 0}},emits:["scroll"],setup(e,{emit:o}){const n={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let t=null,u,c;N(()=>e.scrollTarget,()=>{i(),b()});function v(){t!==null&&t();const w=Math.max(0,Ie(u)),_=Le(u),s={top:w-n.position.top,left:_-n.position.left};if(e.axis==="vertical"&&s.top===0||e.axis==="horizontal"&&s.left===0)return;const p=Math.abs(s.top)>=Math.abs(s.left)?s.top<0?"up":"down":s.left<0?"left":"right";n.position={top:w,left:_},n.directionChanged=n.direction!==p,n.delta=s,n.directionChanged===!0&&(n.direction=p,n.inflectionPoint=n.position),o("scroll",{...n})}function b(){u=Pe(c,e.scrollTarget),u.addEventListener("scroll",d,$),d(!0)}function i(){u!==void 0&&(u.removeEventListener("scroll",d,$),u=void 0)}function d(w){if(w===!0||e.debounce===0||e.debounce==="0")v();else if(t===null){const[_,s]=e.debounce?[setTimeout(v,e.debounce),clearTimeout]:[requestAnimationFrame(v),cancelAnimationFrame];t=()=>{s(_),t=null}}}const{proxy:m}=V();return N(()=>m.$q.lang.rtl,v),ae(()=>{c=m.$el.parentNode,b()}),se(()=>{t!==null&&t(),i()}),Object.assign(m,{trigger:d,getPosition:()=>n}),re}}),Te=I({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:o,emit:n}){const{proxy:{$q:t}}=V(),u=g(null),c=g(t.screen.height),v=g(e.container===!0?0:t.screen.width),b=g({position:0,direction:"down",inflectionPoint:0}),i=g(0),d=g(ce.value===!0?0:A()),m=y(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),w=y(()=>e.container===!1?{minHeight:t.screen.height+"px"}:null),_=y(()=>d.value!==0?{[t.lang.rtl===!0?"left":"right"]:`${d.value}px`}:null),s=y(()=>d.value!==0?{[t.lang.rtl===!0?"right":"left"]:0,[t.lang.rtl===!0?"left":"right"]:`-${d.value}px`,width:`calc(100% + ${d.value}px)`}:null);function p(l){if(e.container===!0||document.qScrollPrevented!==!0){const h={position:l.position.top,direction:l.direction,directionChanged:l.directionChanged,inflectionPoint:l.inflectionPoint.top,delta:l.delta.top};b.value=h,e.onScroll!==void 0&&n("scroll",h)}}function L(l){const{height:h,width:x}=l;let P=!1;c.value!==h&&(P=!0,c.value=h,e.onScrollHeight!==void 0&&n("scrollHeight",h),r()),v.value!==x&&(P=!0,v.value=x),P===!0&&e.onResize!==void 0&&n("resize",l)}function f({height:l}){i.value!==l&&(i.value=l,r())}function r(){if(e.container===!0){const l=c.value>i.value?A():0;d.value!==l&&(d.value=l)}}let C;const a={instances:{},view:y(()=>e.view),isContainer:y(()=>e.container),rootRef:u,height:c,containerHeight:i,scrollbarWidth:d,totalWidth:y(()=>v.value+d.value),rows:y(()=>{const l=e.view.toLowerCase().split(" ");return{top:l[0].split(""),middle:l[1].split(""),bottom:l[2].split("")}}),header:B({size:0,offset:0,space:!1}),right:B({size:300,offset:0,space:!1}),footer:B({size:0,offset:0,space:!1}),left:B({size:300,offset:0,space:!1}),scroll:b,animate(){C!==void 0?clearTimeout(C):document.body.classList.add("q-body--layout-animate"),C=setTimeout(()=>{document.body.classList.remove("q-body--layout-animate"),C=void 0},155)},update(l,h,x){a[l][h]=x}};if(fe(ve,a),A()>0){let x=function(){l=null,h.classList.remove("hide-scrollbar")},P=function(){if(l===null){if(h.scrollHeight>t.screen.height)return;h.classList.add("hide-scrollbar")}else clearTimeout(l);l=setTimeout(x,300)},F=function(U){l!==null&&U==="remove"&&(clearTimeout(l),x()),window[`${U}EventListener`]("resize",P)},l=null;const h=document.body;N(()=>e.container!==!0?"add":"remove",F),e.container!==!0&&F("add"),de(()=>{F("remove")})}return()=>{const l=le(o.default,[q(ze,{onScroll:p}),q(J,{onResize:L})]),h=q("div",{class:m.value,style:w.value,ref:e.container===!0?void 0:u,tabindex:-1},l);return e.container===!0?q("div",{class:"q-layout-container overflow-hidden",ref:u},[q(J,{onResize:f}),q("div",{class:"absolute-full",style:_.value},[q("div",{class:"scroll",style:s.value},[h])])]):h}}});const Qe={setup(){const e=M(),o=g(!0),n=g(!1),t=g(!1),u=g(!1),c=g([]),v=g(""),b=g(""),i=g(""),d=async()=>{if(n.value)if(c.value.find(r=>r.item.key.toLowerCase()===v.value.toLowerCase()))t.value=!0;else{const r={key:v.value,value:b.value};c.value=[...c.value,{item:r,isEditing:!1}],t.value=!1,n.value=!1,v.value="",b.value="",await W.addProfileItem(r)}else n.value=!0},m=f=>{i.value=f.target.innerText},w=()=>{t.value=!1},_=(f,r)=>{u.value=!0,console.log(r),r===""||r==="---"?s(f,"",!0):s(f,r,!0)},s=async(f,r,C)=>{c.value=c.value.map(l=>l.item.key===f?{item:{key:f,value:r},isEditing:C}:l);const a=await W.editProfileItem({key:f,value:r});console.log(a.data)};return{profileItems:c,store:e,newItemKey:v,newItemValue:b,isCreating:n,isEditing:u,isCreationError:t,isPageLoading:o,addItem:d,inputChange:m,saveItem:async(f,r)=>{i.value!==""?(s(f,i.value,!1),i.value=""):s(f,r,!1),u.value=!1},setIsEditingItemTrue:_,setIsCreationErrorFalse:w,deleteProfileItem:async f=>{c.value=c.value.filter(C=>C.item.key!==f.key);const r=await W.deleteProfileItem(f);console.log(r.data)}}},async mounted(){const e=this.store.user.profileInfo.map(o=>JSON.parse(o));this.profileItems=e.map(o=>({item:o,isEditing:!1})),this.isPageLoading=!1},components:{PrimaryButton:Se,HeaderLayout:Ce},async beforeRouteEnter(e,o,n){await ge.initUser(),M().isAuth?n():n("/")}},Re={key:0},He={class:"q-pa-md list-container"},Ve=H("h1",{class:"page-title"},"Profile",-1),Fe=["contenteditable"],We={class:"q-mb-xs justify-center items-center column"},Oe={key:0,class:"error-msg"};function Ae(e,o,n,t,u,c){const v=K("HeaderLayout"),b=K("PrimaryButton");return t.isPageLoading?T("",!0):(E(),z("div",Re,[k(Te,null,{default:S(()=>[k(v),H("div",He,[Ve,k(xe,{class:"items-list",bordered:""},{default:S(()=>[(E(!0),z(he,null,ye(t.profileItems,(i,d)=>(E(),z("div",{key:d,class:"item q-ml-xl"},[k(Q,{class:"row items-center"},{default:S(()=>[k(pe,{class:"item__name text-grey text-capitalize"},{default:S(()=>[be(O(i.item.key),1)]),_:2},1024),k(Y,{onClick:m=>t.deleteProfileItem(i.item),class:"option-icon",flat:"",round:"",dense:"",icon:"clear"},null,8,["onClick"])]),_:2},1024),k(Q,{class:"row items-center"},{default:S(()=>[H("div",{onInput:o[0]||(o[0]=(...m)=>t.inputChange&&t.inputChange(...m)),class:j(["info-input tight-text",i.isEditing?"info-input_active":""]),contenteditable:i.isEditing?"true":"false"},O(i.item.value),43,Fe),k(Y,{onClick:m=>t.isEditing?t.saveItem(i.item.key,i.item.value):t.setIsEditingItemTrue(i.item.key,i.item.value),class:j([t.isEditing&&!i.isEditing?"hidden":"","option-icon"]),flat:"",round:"",dense:"",icon:i.isEditing?"check":"edit"},null,8,["onClick","class","icon"])]),_:2},1024)]))),128))]),_:1})]),k(qe,{class:"q-mb-lg column items-center",onSubmit:t.addItem},{default:S(()=>[H("div",We,[t.isCreating?(E(),D(Q,{key:0,onInput:t.setIsCreationErrorFalse},{default:S(()=>[k(G,{filled:"",modelValue:t.newItemKey,"onUpdate:modelValue":o[1]||(o[1]=i=>t.newItemKey=i),label:"key","label-color":"grey",color:"white","lazy-rules":"",rules:[i=>!!i||"Key is required"]},null,8,["modelValue","rules"])]),_:1},8,["onInput"])):T("",!0),t.isCreating?(E(),D(Q,{key:1},{default:S(()=>[k(G,{mask:"",filled:"",modelValue:t.newItemValue,"onUpdate:modelValue":o[2]||(o[2]=i=>t.newItemValue=i),label:"value","label-color":"grey",color:"white","lazy-rules":"",rules:[i=>!!i||"Value is required"]},null,8,["modelValue","rules"])]),_:1})):T("",!0)]),t.isCreating?(E(),z("p",Oe,O(t.isCreationError?"Item with this key already exists":""),1)):T("",!0),k(b,{text:"Add item"})]),_:1},8,["onSubmit"])]),_:1})]))}var Xe=me(Qe,[["render",Ae]]);export{Xe as default};
