import{Q as _,a as d}from"./QForm.52097ba5.js";import{Q as w}from"./vm.6ec6daf4.js";import{_ as b,i as r,u as p,o as c,a as V,e as m,w as x,A as g,U,d as l,t as k,j as f,k as y,l as E,g as L,f as P}from"./index.abd329e6.js";import{v as R}from"./emailValidation.001f0b79.js";import{P as S}from"./PrimaryButton.e15b86c6.js";const T={setup(){const a=r(""),o=r(""),t=r(""),e=r(!1),i=r(!1),u=L(),n=p();return{email:a,password:o,isLoading:e,isRegistrationError:i,username:t,pushToLogin:()=>{u.push("/login")},submitForm:async()=>{try{e.value=!0,i.value=!1,await new Promise(v=>setTimeout(v,600)),await g.registration({email:a.value,username:t.value,password:o.value}),await g.login({email:a.value,password:o.value});const h=await U.getUser();n.setIsAuth(!0),n.setUser(h.data),u.push("/profile")}catch{i.value=!0,e.value=!1}},validateEmail:R}},components:{PrimaryButton:S},beforeRouteEnter(a,o,t){p().isAuth?t("/profile"):t()}},A={class:"absolute-center"},B=l("h1",{class:"page-title"},"Registration",-1),Q={class:"text-negative error-msg"},z={class:"submit"},C={class:"q-mt-md text-grey"};function F(a,o,t,e,i,u){const n=P("primary-button");return c(),V("div",A,[m(_,{onSubmit:e.submitForm},{default:x(()=>[B,m(d,{filled:"",modelValue:e.email,"onUpdate:modelValue":o[0]||(o[0]=s=>e.email=s),label:"Email","label-color":"grey",color:"white","lazy-rules":"",rules:[s=>!!s||"Email is missing",()=>e.validateEmail(e.email)||"Invalid email"]},null,8,["modelValue","rules"]),m(d,{filled:"",modelValue:e.username,"onUpdate:modelValue":o[1]||(o[1]=s=>e.username=s),label:"Username","label-color":"grey",color:"white",type:"text","lazy-rules":"",rules:[s=>s&&s.length>0||"Please type your username"]},null,8,["modelValue","rules"]),m(d,{filled:"",modelValue:e.password,"onUpdate:modelValue":o[2]||(o[2]=s=>e.password=s),label:"Password","label-color":"grey",color:"white",type:"password","lazy-rules":"",rules:[s=>s&&s.length>0||"Please type password"]},null,8,["modelValue","rules"]),l("p",Q,k(e.isRegistrationError?"User with this email already exists":""),1),l("div",z,[e.isLoading?y("",!0):(c(),f(n,{key:0,class:"btn",text:"Registration"})),e.isLoading?(c(),f(w,{key:1,color:"white",size:"3em",thickness:2})):y("",!0)]),l("p",C,[E(" Already have an account? "),l("a",{onClick:o[3]||(o[3]=(...s)=>e.pushToLogin&&e.pushToLogin(...s)),class:"q-ml-sm text-white cursor-pointer tight-text"},"Login")])]),_:1},8,["onSubmit"])])}var H=b(T,[["render",F]]);export{H as default};
